# ╔══════════════════════════════════════════════════════════════════════════════╗
# ║                           TMUX CONFIGURATION                                  ║
# ║                     Otimizado para produtividade                              ║
# ╚══════════════════════════════════════════════════════════════════════════════╝

# ══════════════════════════════════════════════════════════════════════════════
# CONFIGURAÇÕES BÁSICAS
# ══════════════════════════════════════════════════════════════════════════════

# Terminal com suporte a cores
set -g default-terminal "tmux-256color"
set -ag terminal-overrides ",xterm-256color:RGB"

# Habilitar mouse
set -g mouse on

# Começar índices em 1 (mais ergonômico no teclado)
set -g base-index 1
setw -g pane-base-index 1

# Renumerar janelas automaticamente
set -g renumber-windows on

# Aumentar histórico de scroll
set -g history-limit 50000

# Reduzir delay do escape (importante para Vim/Neovim)
set -sg escape-time 0

# Aumentar tempo de exibição de mensagens
set -g display-time 4000

# Refresh do status bar a cada segundo
set -g status-interval 1

# Focus events (necessário para alguns plugins do Neovim)
set -g focus-events on

# Clipboard do sistema
set -g set-clipboard on

# ══════════════════════════════════════════════════════════════════════════════
# PREFIXO E KEYBINDINGS
# ══════════════════════════════════════════════════════════════════════════════

# Mudar prefixo de C-b para C-a (mais acessível)
unbind C-b
set -g prefix C-a
bind C-a send-prefix

# Recarregar configuração com r
bind r source-file ~/.tmux.conf \; display-message "Config recarregada!"

# ──────────────────────────────────────────────────────────────────────────────
# DIVIDIR PAINÉIS
# ──────────────────────────────────────────────────────────────────────────────

# Split horizontal com | (mais intuitivo)
bind | split-window -h -c "#{pane_current_path}"
bind \\ split-window -h -c "#{pane_current_path}"

# Split vertical com -
bind - split-window -v -c "#{pane_current_path}"
bind _ split-window -v -c "#{pane_current_path}"

# Remover bindings padrão confusos
unbind '"'
unbind %

# Nova janela no diretório atual
bind c new-window -c "#{pane_current_path}"

# ──────────────────────────────────────────────────────────────────────────────
# NAVEGAÇÃO ESTILO VIM
# ──────────────────────────────────────────────────────────────────────────────

# Navegar entre painéis com hjkl
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Navegar sem prefixo usando Alt+hjkl
bind -n M-h select-pane -L
bind -n M-j select-pane -D
bind -n M-k select-pane -U
bind -n M-l select-pane -R

# Navegar com setas (alternativa)
bind -n M-Left select-pane -L
bind -n M-Right select-pane -R
bind -n M-Up select-pane -U
bind -n M-Down select-pane -D

# ──────────────────────────────────────────────────────────────────────────────
# REDIMENSIONAR PAINÉIS
# ──────────────────────────────────────────────────────────────────────────────

# Redimensionar com HJKL (maiúsculo)
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# Redimensionar com Ctrl+setas
bind -r C-Left resize-pane -L 5
bind -r C-Right resize-pane -R 5
bind -r C-Up resize-pane -U 5
bind -r C-Down resize-pane -D 5

# ──────────────────────────────────────────────────────────────────────────────
# JANELAS E SESSÕES
# ──────────────────────────────────────────────────────────────────────────────

# Navegar entre janelas
bind -n S-Left previous-window
bind -n S-Right next-window

# Mover janelas
bind -n C-S-Left swap-window -t -1 \; previous-window
bind -n C-S-Right swap-window -t +1 \; next-window

# Alternar última janela
bind Tab last-window

# Selecionar janela por número (Alt+número)
bind -n M-1 select-window -t 1
bind -n M-2 select-window -t 2
bind -n M-3 select-window -t 3
bind -n M-4 select-window -t 4
bind -n M-5 select-window -t 5
bind -n M-6 select-window -t 6
bind -n M-7 select-window -t 7
bind -n M-8 select-window -t 8
bind -n M-9 select-window -t 9

# Fechar painel/janela com confirmação
bind x confirm-before -p "Fechar painel? (y/n)" kill-pane
bind X confirm-before -p "Fechar janela? (y/n)" kill-window

# ──────────────────────────────────────────────────────────────────────────────
# MODO DE CÓPIA (ESTILO VIM)
# ──────────────────────────────────────────────────────────────────────────────

setw -g mode-keys vi

# Entrar no modo de cópia
bind v copy-mode

# Seleção e cópia estilo Vim
bind -T copy-mode-vi v send-keys -X begin-selection
bind -T copy-mode-vi V send-keys -X select-line
bind -T copy-mode-vi C-v send-keys -X rectangle-toggle
bind -T copy-mode-vi y send-keys -X copy-selection-and-cancel
bind -T copy-mode-vi Escape send-keys -X cancel

# Busca incremental
bind -T copy-mode-vi / command-prompt -i -p "Buscar:" "send -X search-forward-incremental \"%%%\""
bind -T copy-mode-vi ? command-prompt -i -p "Buscar:" "send -X search-backward-incremental \"%%%\""

# ══════════════════════════════════════════════════════════════════════════════
# TEMA CATPPUCCIN (MOCHA)
# ══════════════════════════════════════════════════════════════════════════════

# Cores Catppuccin Mocha
thm_bg="#1e1e2e"
thm_fg="#cdd6f4"
thm_cyan="#89dceb"
thm_black="#181825"
thm_gray="#313244"
thm_magenta="#cba6f7"
thm_pink="#f5c2e7"
thm_red="#f38ba8"
thm_green="#a6e3a1"
thm_yellow="#f9e2af"
thm_blue="#89b4fa"
thm_orange="#fab387"
thm_lavender="#b4befe"

# ──────────────────────────────────────────────────────────────────────────────
# STATUS BAR
# ──────────────────────────────────────────────────────────────────────────────

set -g status on
set -g status-position bottom
set -g status-justify left
set -g status-style "bg=${thm_bg},fg=${thm_fg}"

# Lado esquerdo: sessão
set -g status-left-length 100
set -g status-left "#[fg=${thm_black},bg=${thm_blue},bold]  #S #[fg=${thm_blue},bg=${thm_bg}]"

# Lado direito: informações
set -g status-right-length 100
set -g status-right "#[fg=${thm_gray}]#[fg=${thm_fg},bg=${thm_gray}]  %H:%M #[fg=${thm_blue},bg=${thm_gray}]#[fg=${thm_black},bg=${thm_blue}]  %d/%m/%Y "

# ──────────────────────────────────────────────────────────────────────────────
# JANELAS NO STATUS BAR
# ──────────────────────────────────────────────────────────────────────────────

# Janela inativa
set -g window-status-format "#[fg=${thm_bg},bg=${thm_gray}] #[fg=${thm_fg},bg=${thm_gray}]#I #W #[fg=${thm_gray},bg=${thm_bg}]"

# Janela ativa
set -g window-status-current-format "#[fg=${thm_bg},bg=${thm_lavender}] #[fg=${thm_black},bg=${thm_lavender},bold]#I #W #[fg=${thm_lavender},bg=${thm_bg}]"

# Separador entre janelas
set -g window-status-separator ""

# ──────────────────────────────────────────────────────────────────────────────
# PAINÉIS
# ──────────────────────────────────────────────────────────────────────────────

# Bordas dos painéis
set -g pane-border-style "fg=${thm_gray}"
set -g pane-active-border-style "fg=${thm_blue}"

# Indicador de painel
set -g display-panes-colour "${thm_gray}"
set -g display-panes-active-colour "${thm_blue}"

# ──────────────────────────────────────────────────────────────────────────────
# MENSAGENS E MENUS
# ──────────────────────────────────────────────────────────────────────────────

set -g message-style "bg=${thm_gray},fg=${thm_fg}"
set -g message-command-style "bg=${thm_gray},fg=${thm_fg}"

# Menu de seleção
set -g mode-style "bg=${thm_lavender},fg=${thm_black}"

# ──────────────────────────────────────────────────────────────────────────────
# RELÓGIO
# ──────────────────────────────────────────────────────────────────────────────

set -g clock-mode-colour "${thm_blue}"
set -g clock-mode-style 24

# ══════════════════════════════════════════════════════════════════════════════
# PLUGINS (TPM - Tmux Plugin Manager)
# ══════════════════════════════════════════════════════════════════════════════

# Instalar TPM se não existir:
# git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm

# Lista de plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @plugin 'christoomey/vim-tmux-navigator'

# ──────────────────────────────────────────────────────────────────────────────
# CONFIGURAÇÃO DOS PLUGINS
# ──────────────────────────────────────────────────────────────────────────────

# tmux-resurrect: salvar estado das sessões
set -g @resurrect-capture-pane-contents 'on'
set -g @resurrect-strategy-nvim 'session'

# tmux-continuum: auto-save e auto-restore
set -g @continuum-restore 'on'
set -g @continuum-save-interval '15'

# vim-tmux-navigator: navegação seamless entre vim e tmux
# Ctrl+hjkl para navegar entre painéis vim/tmux

# ──────────────────────────────────────────────────────────────────────────────
# INICIALIZAR TPM
# ──────────────────────────────────────────────────────────────────────────────

# Manter esta linha no final do .tmux.conf
run '~/.tmux/plugins/tpm/tpm'

# ══════════════════════════════════════════════════════════════════════════════
# ATALHOS RÁPIDOS
# ══════════════════════════════════════════════════════════════════════════════
#
# PREFIXO: Ctrl+a (C-a)
#
# PAINÉIS:
#   C-a |    = Split horizontal
#   C-a -    = Split vertical
#   C-a hjkl = Navegar painéis
#   C-a HJKL = Redimensionar painéis
#   Alt+hjkl = Navegar painéis (sem prefixo)
#
# JANELAS:
#   C-a c        = Nova janela
#   C-a Tab      = Última janela
#   Shift+setas  = Próxima/anterior janela
#   Alt+1-9      = Ir para janela N
#
# MODO CÓPIA:
#   C-a v = Entrar no modo cópia
#   v     = Iniciar seleção
#   y     = Copiar
#   /     = Buscar
#
# SESSÕES:
#   C-a d = Desanexar sessão
#   C-a s = Listar sessões
#   C-a $ = Renomear sessão
#
# PLUGINS (após instalar TPM):
#   C-a I = Instalar plugins
#   C-a U = Atualizar plugins
#
# ══════════════════════════════════════════════════════════════════════════════
